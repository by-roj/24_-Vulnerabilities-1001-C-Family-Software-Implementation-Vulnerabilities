# (Non-linear) Out-Of-Bounds Writes (OOB-W) (CVE-2020-0938)

***---------------------------------------- IN PROGRESS ----------------------------------------***



<br>



|CVE            |CVE-2020-0938                                   |
|---------------|------------------------------------------------|
|Software Source|Microsoft                                       |
|Type           |Kernel space (Win <= 8.1), Userspace (Win >= 10)|
|SubType        |Library (Adobe Type 1 font parsing)             |
|Attack Surface |Fonts (Adobe Type 1 fonts)                      |



<br>



### Summary

- Affected versions
    - Windows 7 through 10, prior to the April 2020 patch
    - Windows 8 - an Adobe Type Manager Font Driver(ATMFD) in kernelspace that was responsible for parsing Adobe PostScript fonts (`atmfd.dll`) 
    - Windows 10 - that attack surface was deprivileged and made to run in userspace (`fontdrvhost.exe`) 



<br>



### Vulnerability

```
// ACID: num_master

int SetBlendDesignPositions(void *arg) {
  int num_master;
  Fixed16_16 values[16][15];

  for (num_master = 0; ; num_master++) {
    //KC: break if all tokens have been read from input stream
    if (GetToken() != TOKEN_OPEN) {
      break;
    }
    /* KC: writes a SACI number (0-14) of fixed point values from an ACID token in
     * input stream to &values[num_master] */
    int values_read = GetOpenFixedArray(&values[num_master], 15);
    SetNumAxes(values_read);
  }

  SetNumMasters(num_master);

  for (int i = 0; i < num_master; i++) {
    procs->BlendDesignPositions(i, &values[i]);
  }

  return 0;
}
```

- `BlendDesignpositions` 
